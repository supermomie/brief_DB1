Database evaluation
===================

Table structure for table questionsreponses
-------------------------------------------
| Column         		|     Type	        					| Null | Default | Links to | Comments | Media (MIME) type |
|:---------------------:|:--------------------------------:|:----------:|:-------:|:---------:|:----------:|:----------:|
| questions         	| text| No                             |      |  |   |   | 
| reponse         		| text| No                             |      |  |   |   | 
| id         		    | text| No                             |      |  |   |   | 


Dumping data for table questionsreponses
----------------------------------------




| questions         		|     reponses	        					| id |
|:---------------------:|:--------------------------------:|:-----------:|
| Combien de doublons avons-nous         	| 1) SELECT COUNT(*) AS nbr_doublon, SHIPPING_MODE, SHIPPING_PRICE, WARRANTIES_FLG, WARRANTIES_PRICE, CARD_PAYMENT, COUPON_PAYMENT, RSP_PAYMENT, WALLET_PAYMENT, PRICECLUB_STATUS REGISTRATION_DATE, PURCHASE_COUNT, BUYER_BIRTHDAY_DATE, BUYER_DEPARTMENT, BUYING_DATE, SELLER_SCORE_COUNT, SELLER_SCORE_AVERAGE, SELLER_COUNTRY, SELLER_DEPARTMENT, PRODUCT_TYPE, PRODUCT_FAMILY, ITEM_PRICE FROM  base1 GROUP BY SHIPPING_MODE, SHIPPING_PRICE, WARRANTIES_FLG, WARRANTIES_PRICE, CARD_PAYMENT, COUPON_PAYMENT, RSP_PAYMENT, WALLET_PAYMENT, PRICECLUB_STATUS, REGISTRATION_DATE, PURCHASE_COUNT, BUYER_BIRTHDAY_DATE, BUYER_DEPARTMENT, BUYING_DATE, SELLER_SCORE_COUNT, SELLER_SCORE_AVERAGE, SELLER_COUNTRY, SELLER_DEPARTMENT, PRODUCT_TYPE, PRODUCT_FAMILY, ITEM_PRICE HAVING   COUNT(*) > 1; 2) SELECT COUNT(ID)FROM (SELECT ID,ROW_NUMBER() OVER (PARTITION BY ID ORDER BY ID) AS row_num FROM base1) t WHERE row_num > 1| 1 |
| Supprimer les doublons        	| DELETE FROM base2 WHERE id_ID IN (SELECT ID FROM ( SELECT ID, ROW_NUMBER() OVER ( PARTITION BY ID ORDER BY id_ID) AS row_num FROM base2 ) t WHERE row_num > 1);| 2 |
| Combien de vendeurs étrangers avons-nous | SELECT COUNT(*) FROM `base2` WHERE SELLER_COUNTRY NOT LIKE "%FRANCE%" | 3 |
| Creer la table vendeur1 composée des vendeurs étrangers, la table vendeur2 composée des vendeurs français et la table vendeur3 composées des vendeurs français basés en métropole| 1) CREATE TABLE vendeur1 AS SELECT * FROM `base2` WHERE SELLER_COUNTRY NOT LIKE "%FRANCE%" 2) CREATE TABLE vendeur2 AS SELECT * FROM base2 WHERE SELLER_COUNTRY LIKE "%FRANCE%" 3) CREATE TABLE vendeur3 AS SELECT * FROM base2 WHERE SELLER_COUNTRY LIKE "%FRANCE_ METROPOLITAN%";| 4 |
| Quelle est la probabilité pour un vendeur français d'avoir un bon score si la vente a lieu un lundi          	| SELECT AVG(SELLER_SCORE_AVERAGE) FROM vendeur2;| 5 |
| Quel est le montant total des articles vendus par famille de produits         	| SELECT PRODUCT_TYPE, COUNT(PRODUCT_TYPE), ITEM_PRICE, SUM(CASE WHEN INSTR(ITEM_PRICE, "<") <> 0 THEN SUBSTR(ITEM_PRICE, 1, INSTR(ITEM_PRICE, "<") - 1) + (SUBSTR(ITEM_PRICE, INSTR(ITEM_PRICE, "<") + 1) - SUBSTR(ITEM_PRICE, 1, INSTR(ITEM_PRICE, "<") - 1)) / 2 END) AS "SOMME TOTAL MOYEN" FROM base2 GROUP BY PRODUCT_TYPE;| 6 |
| Entre nationaux et étrangers qui sont ceux qui ont le plus vendu d'articles| SELECT SELLER_COUNTRY, PRODUCT_TYPE, SUM(CASE WHEN INSTR(PURCHASE_COUNT, "<") <> 0 THEN SUBSTR(PURCHASE_COUNT, 1, INSTR(PURCHASE_COUNT, "<") - 1) + (SUBSTR(PURCHASE_COUNT, INSTR(PURCHASE_COUNT, "<") + 1) - SUBSTR(PURCHASE_COUNT, 1, INSTR(PURCHASE_COUNT, "<") - 1)) / 2 END) AS "total" FROM base2 GROUP BY PRODUCT_TYPE, SELLER_COUNTRY ORDER BY total DESC;| 7 |
|Créer la table produit_1 (à partir de la table vendeur1) comportant le montant des types de produits par famille de produits | CREATE TABLE product_1 AS SELECT PRODUCT_TYPE, PRODUCT_FAMILY, ITEM_PRICE,  SUM(CASE          WHEN INSTR(PURCHASE_COUNT, "<") <> 0 AND SUBSTR(PURCHASE_COUNT, 1, INSTR(PURCHASE_COUNT, "<") - 1) = "" THEN SUBSTR(PURCHASE_COUNT, INSTR(PURCHASE_COUNT, "<") + 1) / 2         WHEN INSTR(PURCHASE_COUNT, "<") <> 0 THEN SUBSTR(PURCHASE_COUNT, 1, INSTR(PURCHASE_COUNT, "<") - 1) + (SUBSTR(PURCHASE_COUNT, INSTR(PURCHASE_COUNT, "<") + 1) - SUBSTR(PURCHASE_COUNT, 1, INSTR(PURCHASE_COUNT, "<") - 1)) / 2         WHEN INSTR(PURCHASE_COUNT, ">") <> 0 THEN SUBSTR(PURCHASE_COUNT, INSTR(PURCHASE_COUNT, ">") + 1) / 2         ELSE 0     END) AS "MOYENNE",   SUM(CASE          WHEN INSTR(ITEM_PRICE, "<") <> 0 AND SUBSTR(ITEM_PRICE, 1, INSTR(ITEM_PRICE, "<") - 1) = "" THEN SUBSTR(ITEM_PRICE, INSTR(ITEM_PRICE, "<") + 1) / 2         WHEN INSTR(ITEM_PRICE, "<") <> 0 THEN SUBSTR(ITEM_PRICE, 1, INSTR(ITEM_PRICE, "<") - 1) + (SUBSTR(ITEM_PRICE, INSTR(ITEM_PRICE, "<") + 1) - SUBSTR(ITEM_PRICE, 1, INSTR(ITEM_PRICE, "<") - 1)) / 2         WHEN INSTR(ITEM_PRICE, ">") <> 0 THEN SUBSTR(ITEM_PRICE, INSTR(ITEM_PRICE, ">") + 1) / 2         ELSE 0     END) AS "TOTAL" FROM vendeur1 GROUP BY ITEM_PRICE, PRODUCT_TYPE, PRODUCT_FAMILY;| 8 |
|Créer la table produit_2 (à partir de la table vendeur2) comportant le montant des types de produits par famille de produits |CREATE TABLE product_2 AS SELECT PRODUCT_TYPE, PRODUCT_FAMILY, ITEM_PRICE,  SUM(CASE          WHEN INSTR(PURCHASE_COUNT, "<") <> 0 AND SUBSTR(PURCHASE_COUNT, 1, INSTR(PURCHASE_COUNT, "<") - 1) = "" THEN SUBSTR(PURCHASE_COUNT, INSTR(PURCHASE_COUNT, "<") + 1) / 2         WHEN INSTR(PURCHASE_COUNT, "<") <> 0 THEN SUBSTR(PURCHASE_COUNT, 1, INSTR(PURCHASE_COUNT, "<") - 1) + (SUBSTR(PURCHASE_COUNT, INSTR(PURCHASE_COUNT, "<") + 1) - SUBSTR(PURCHASE_COUNT, 1, INSTR(PURCHASE_COUNT, "<") - 1)) / 2         WHEN INSTR(PURCHASE_COUNT, ">") <> 0 THEN SUBSTR(PURCHASE_COUNT, INSTR(PURCHASE_COUNT, ">") + 1) / 2         ELSE 0     END) AS "MOYENNE",   SUM(CASE          WHEN INSTR(ITEM_PRICE, "<") <> 0 AND SUBSTR(ITEM_PRICE, 1, INSTR(ITEM_PRICE, "<") - 1) = "" THEN SUBSTR(ITEM_PRICE, INSTR(ITEM_PRICE, "<") + 1) / 2         WHEN INSTR(ITEM_PRICE, "<") <> 0 THEN SUBSTR(ITEM_PRICE, 1, INSTR(ITEM_PRICE, "<") - 1) + (SUBSTR(ITEM_PRICE, INSTR(ITEM_PRICE, "<") + 1) - SUBSTR(ITEM_PRICE, 1, INSTR(ITEM_PRICE, "<") - 1)) / 2         WHEN INSTR(ITEM_PRICE, ">") <> 0 THEN SUBSTR(ITEM_PRICE, INSTR(ITEM_PRICE, ">") + 1) / 2         ELSE 0     END) AS "TOTAL" FROM vendeur2 GROUP BY ITEM_PRICE, PRODUCT_TYPE, PRODUCT_FAMILY; | 9|
|Créer la table produits (à partir des tables vendeur1 & vendeur2) comportant le montant des types de produits par famille de produits : pas de doublons svp|CREATE TABLE products   SELECT PRODUCT_TYPE, PRODUCT_FAMILY, ITEM_PRICE,  	SUM(CASE          WHEN INSTR(PURCHASE_COUNT, "<") <> 0 AND SUBSTR(PURCHASE_COUNT, 1, INSTR(PURCHASE_COUNT, "<") - 1) = "" THEN SUBSTR(PURCHASE_COUNT, INSTR(PURCHASE_COUNT, "<") + 1) / 2         WHEN INSTR(PURCHASE_COUNT, "<") <> 0 THEN SUBSTR(PURCHASE_COUNT, 1, INSTR(PURCHASE_COUNT, "<") - 1) + (SUBSTR(PURCHASE_COUNT, INSTR(PURCHASE_COUNT, "<") + 1) - SUBSTR(PURCHASE_COUNT, 1, INSTR(PURCHASE_COUNT, "<") - 1)) / 2         WHEN INSTR(PURCHASE_COUNT, ">") <> 0 THEN SUBSTR(PURCHASE_COUNT, INSTR(PURCHASE_COUNT, ">") + 1) / 2         ELSE 0     END) AS "MOYENNE",     SUM(CASE          WHEN INSTR(ITEM_PRICE, "<") <> 0 AND SUBSTR(ITEM_PRICE, 1, INSTR(ITEM_PRICE, "<") - 1) = "" THEN SUBSTR(ITEM_PRICE, INSTR(ITEM_PRICE, "<") + 1) / 2         WHEN INSTR(ITEM_PRICE, "<") <> 0 THEN SUBSTR(ITEM_PRICE, 1, INSTR(ITEM_PRICE, "<") - 1) + (SUBSTR(ITEM_PRICE, INSTR(ITEM_PRICE, "<") + 1) - SUBSTR(ITEM_PRICE, 1, INSTR(ITEM_PRICE, "<") - 1)) / 2         WHEN INSTR(ITEM_PRICE, ">") <> 0 THEN SUBSTR(ITEM_PRICE, INSTR(ITEM_PRICE, ">") + 1) / 2         ELSE 0     END) AS "TOTAL"   	FROM vendeur1     GROUP BY ITEM_PRICE, PRODUCT_TYPE, PRODUCT_FAMILY     UNION   SELECT PRODUCT_TYPE, PRODUCT_FAMILY, ITEM_PRICE,  	SUM(CASE          WHEN INSTR(PURCHASE_COUNT, "<") <> 0 AND SUBSTR(PURCHASE_COUNT, 1, INSTR(PURCHASE_COUNT, "<") - 1) = "" THEN SUBSTR(PURCHASE_COUNT, INSTR(PURCHASE_COUNT, "<") + 1) / 2         WHEN INSTR(PURCHASE_COUNT, "<") <> 0 THEN SUBSTR(PURCHASE_COUNT, 1, INSTR(PURCHASE_COUNT, "<") - 1) + (SUBSTR(PURCHASE_COUNT, INSTR(PURCHASE_COUNT, "<") + 1) - SUBSTR(PURCHASE_COUNT, 1, INSTR(PURCHASE_COUNT, "<") - 1)) / 2         WHEN INSTR(PURCHASE_COUNT, ">") <> 0 THEN SUBSTR(PURCHASE_COUNT, INSTR(PURCHASE_COUNT, ">") + 1) / 2         ELSE 0     END) AS "MOYENNE",     SUM(CASE          WHEN INSTR(ITEM_PRICE, "<") <> 0 AND SUBSTR(ITEM_PRICE, 1, INSTR(ITEM_PRICE, "<") - 1) = "" THEN SUBSTR(ITEM_PRICE, INSTR(ITEM_PRICE, "<") + 1) / 2         WHEN INSTR(ITEM_PRICE, "<") <> 0 THEN SUBSTR(ITEM_PRICE, 1, INSTR(ITEM_PRICE, "<") - 1) + (SUBSTR(ITEM_PRICE, INSTR(ITEM_PRICE, "<") + 1) - SUBSTR(ITEM_PRICE, 1, INSTR(ITEM_PRICE, "<") - 1)) / 2         WHEN INSTR(ITEM_PRICE, ">") <> 0 THEN SUBSTR(ITEM_PRICE, INSTR(ITEM_PRICE, ">") + 1) / 2         ELSE 0     END) AS "TOTAL"   FROM vendeur2    GROUP BY ITEM_PRICE, PRODUCT_TYPE, PRODUCT_FAMILY;| 10|
|En considérant que le deuxième achat effectué par un client constitue un complément d'achat et non un doublon, l'entreprise vous demande de créer à partir du fichier csv de départ une nouvelle table nommée vente_finale en affichant pas les ventes complémentaires. Toutefois les montants affectés à ces ventes doivent figurer dans la nouvelles table.|C|11|