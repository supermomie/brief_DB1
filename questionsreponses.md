Database evaluation
===================

Table structure for table questionsreponses
-------------------------------------------

  ----------- --------- ------ --------- ---------- ---------- -------------------
  Column      Type      Null   Default   Links to   Comments   Media (MIME) type
  id          int(11)   No                                     
  questions   text      No                                     
  reponses    text      No                                     
  ----------- --------- ------ --------- ---------- ---------- -------------------

Dumping data for table questionsreponses
----------------------------------------

  ---- ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
  id   questions                                                                                                                                                                                                                                                                                                                                                          reponses
  1    combien de doublons avons-nous                                                                                                                                                                                                                                                                                                                                     1\) SELECT COUNT(\*) AS nbr\_doublon, SHIPPING\_MODE, SHIPPING\_PRICE,
                                                                                                                                                                                                                                                                                                                                                                          WARRANTIES\_FLG, WARRANTIES\_PRICE, CARD\_PAYMENT, COUPON\_PAYMENT,
                                                                                                                                                                                                                                                                                                                                                                          RSP\_PAYMENT, WALLET\_PAYMENT, PRICECLUB\_STATUS REGISTRATION\_DATE,
                                                                                                                                                                                                                                                                                                                                                                          PURCHASE\_COUNT, BUYER\_BIRTHDAY\_DATE, BUYER\_DEPARTMENT, BUYING\_DATE,
                                                                                                                                                                                                                                                                                                                                                                          SELLER\_SCORE\_COUNT, SELLER\_SCORE\_AVERAGE, SELLER\_COUNTRY,
                                                                                                                                                                                                                                                                                                                                                                          SELLER\_DEPARTMENT, PRODUCT\_TYPE, PRODUCT\_FAMILY, ITEM\_PRICE FROM
                                                                                                                                                                                                                                                                                                                                                                          base1 GROUP BY SHIPPING\_MODE, SHIPPING\_PRICE, WARRANTIES\_FLG,
                                                                                                                                                                                                                                                                                                                                                                          WARRANTIES\_PRICE, CARD\_PAYMENT, COUPON\_PAYMENT, RSP\_PAYMENT,
                                                                                                                                                                                                                                                                                                                                                                          WALLET\_PAYMENT, PRICECLUB\_STATUS, REGISTRATION\_DATE, PURCHASE\_COUNT,
                                                                                                                                                                                                                                                                                                                                                                          BUYER\_BIRTHDAY\_DATE, BUYER\_DEPARTMENT, BUYING\_DATE,
                                                                                                                                                                                                                                                                                                                                                                          SELLER\_SCORE\_COUNT, SELLER\_SCORE\_AVERAGE, SELLER\_COUNTRY,
                                                                                                                                                                                                                                                                                                                                                                          SELLER\_DEPARTMENT, PRODUCT\_TYPE, PRODUCT\_FAMILY, ITEM\_PRICE HAVING
                                                                                                                                                                                                                                                                                                                                                                          COUNT(\*) \> 1; 2) SELECT COUNT(ID)FROM (SELECT ID,ROW\_NUMBER() OVER
                                                                                                                                                                                                                                                                                                                                                                          (PARTITION BY ID ORDER BY ID) AS row\_num FROM base1) t WHERE row\_num
                                                                                                                                                                                                                                                                                                                                                                          \> 1
  2    supprimer les doublons                                                                                                                                                                                                                                                                                                                                             DELETE FROM base2 WHERE id\_ID IN (SELECT ID FROM ( SELECT ID, ROW\_NUMBER() OVER ( PARTITION BY ID ORDER BY id\_ID) AS row\_num FROM base2 ) t WHERE row\_num \> 1)
  3    combien de vendeurs étrangers avons-nous                                                                                                                                                                                                                                                                                                                           SELECT COUNT(\*) FROM \`base2\` WHERE SELLER\_COUNTRY NOT LIKE \"%FRANCE%\"
  4    creer la table vendeur1 composée des vendeurs étrangers, la table vendeur2 composée des vendeurs français et la table vendeur3 composées des vendeurs français basés en métropole                                                                                                                                                                                  1\) CREATE TABLE vendeur1 AS SELECT \* FROM \`base2\` WHERE
                                                                                                                                                                                                                                                                                                                                                                          SELLER\_COUNTRY NOT LIKE \"%FRANCE%\" 2) CREATE TABLE vendeur2 AS SELECT
                                                                                                                                                                                                                                                                                                                                                                          \* FROM base2 WHERE SELLER\_COUNTRY LIKE \"%FRANCE%\" 3) CREATE TABLE
                                                                                                                                                                                                                                                                                                                                                                          vendeur3 AS SELECT \* FROM base2 WHERE SELLER\_COUNTRY LIKE \"%FRANCE\_
                                                                                                                                                                                                                                                                                                                                                                          METROPOLITAN%\"
  5    quelle est la probabilité pour un vendeur français d\'avoir un bon score si la vente a lieu un lundi                                                                                                                                                                                                                                                               SELECT AVG(SELLER\_SCORE\_AVERAGE) FROM vendeur2
  6    quel est le montant total des articles vendus par famille de produits                                                                                                                                                                                                                                                                                              SELECT PRODUCT\_TYPE, COUNT(PRODUCT\_TYPE), ITEM\_PRICE, SUM(CASE WHEN INSTR(ITEM\_PRICE, \"\<\") \<\> 0 THEN SUBSTR(ITEM\_PRICE, 1, INSTR(ITEM\_PRICE, \"\<\") - 1) + (SUBSTR(ITEM\_PRICE, INSTR(ITEM\_PRICE, \"\<\") + 1) - SUBSTR(ITEM\_PRICE, 1, INSTR(ITEM\_PRICE, \"\<\") - 1)) / 2 END) AS \"SOMME TOTAL MOYEN\" FROM base2 GROUP BY PRODUCT\_TYPE
  7    Entre nationaux et étrangers qui sont ceux qui ont le plus vendu d\'articles                                                                                                                                                                                                                                                                                       SELECT SELLER\_COUNTRY, PRODUCT\_TYPE, SUM(CASE WHEN INSTR(PURCHASE\_COUNT, \"\<\") \<\> 0 THEN SUBSTR(PURCHASE\_COUNT, 1, INSTR(PURCHASE\_COUNT, \"\<\") - 1) + (SUBSTR(PURCHASE\_COUNT, INSTR(PURCHASE\_COUNT, \"\<\") + 1) - SUBSTR(PURCHASE\_COUNT, 1, INSTR(PURCHASE\_COUNT, \"\<\") - 1)) / 2 END) AS \"total\" FROM base2 GROUP BY PRODUCT\_TYPE, SELLER\_COUNTRY ORDER BY total DESC
  8    Créer la table produit\_1 (à partir de la table vendeur1) comportant le montant des types de produits par famille de produits                                                                                                                                                                                                                                      CREATE TABLE product\_1 AS SELECT PRODUCT\_TYPE, PRODUCT\_FAMILY, ITEM\_PRICE, SUM(CASE WHEN INSTR(PURCHASE\_COUNT, \"\<\") \<\> 0 AND SUBSTR(PURCHASE\_COUNT, 1, INSTR(PURCHASE\_COUNT, \"\<\") - 1) = \"\" THEN SUBSTR(PURCHASE\_COUNT, INSTR(PURCHASE\_COUNT, \"\<\") + 1) / 2 WHEN INSTR(PURCHASE\_COUNT, \"\<\") \<\> 0 THEN SUBSTR(PURCHASE\_COUNT, 1, INSTR(PURCHASE\_COUNT, \"\<\") - 1) + (SUBSTR(PURCHASE\_COUNT, INSTR(PURCHASE\_COUNT, \"\<\") + 1) - SUBSTR(PURCHASE\_COUNT, 1, INSTR(PURCHASE\_COUNT, \"\<\") - 1)) / 2 WHEN INSTR(PURCHASE\_COUNT, \"\>\") \<\> 0 THEN SUBSTR(PURCHASE\_COUNT, INSTR(PURCHASE\_COUNT, \"\>\") + 1) / 2 ELSE 0 END) AS \"MOYENNE\", SUM(CASE WHEN INSTR(ITEM\_PRICE, \"\<\") \<\> 0 AND SUBSTR(ITEM\_PRICE, 1, INSTR(ITEM\_PRICE, \"\<\") - 1) = \"\" THEN SUBSTR(ITEM\_PRICE, INSTR(ITEM\_PRICE, \"\<\") + 1) / 2 WHEN INSTR(ITEM\_PRICE, \"\<\") \<\> 0 THEN SUBSTR(ITEM\_PRICE, 1, INSTR(ITEM\_PRICE, \"\<\") - 1) + (SUBSTR(ITEM\_PRICE, INSTR(ITEM\_PRICE, \"\<\") + 1) - SUBSTR(ITEM\_PRICE, 1, INSTR(ITEM\_PRICE, \"\<\") - 1)) / 2 WHEN INSTR(ITEM\_PRICE, \"\>\") \<\> 0 THEN SUBSTR(ITEM\_PRICE, INSTR(ITEM\_PRICE, \"\>\") + 1) / 2 ELSE 0 END) AS \"TOTAL\" FROM vendeur1 GROUP BY ITEM\_PRICE, PRODUCT\_TYPE, PRODUCT\_FAMILY
  9    Créer la table produit\_2 (à partir de la table vendeur2) comportant le montant des types de produits par famille de produits                                                                                                                                                                                                                                      CREATE TABLE product\_2 AS SELECT PRODUCT\_TYPE, PRODUCT\_FAMILY, ITEM\_PRICE, SUM(CASE WHEN INSTR(PURCHASE\_COUNT, \"\<\") \<\> 0 AND SUBSTR(PURCHASE\_COUNT, 1, INSTR(PURCHASE\_COUNT, \"\<\") - 1) = \"\" THEN SUBSTR(PURCHASE\_COUNT, INSTR(PURCHASE\_COUNT, \"\<\") + 1) / 2 WHEN INSTR(PURCHASE\_COUNT, \"\<\") \<\> 0 THEN SUBSTR(PURCHASE\_COUNT, 1, INSTR(PURCHASE\_COUNT, \"\<\") - 1) + (SUBSTR(PURCHASE\_COUNT, INSTR(PURCHASE\_COUNT, \"\<\") + 1) - SUBSTR(PURCHASE\_COUNT, 1, INSTR(PURCHASE\_COUNT, \"\<\") - 1)) / 2 WHEN INSTR(PURCHASE\_COUNT, \"\>\") \<\> 0 THEN SUBSTR(PURCHASE\_COUNT, INSTR(PURCHASE\_COUNT, \"\>\") + 1) / 2 ELSE 0 END) AS \"MOYENNE\", SUM(CASE WHEN INSTR(ITEM\_PRICE, \"\<\") \<\> 0 AND SUBSTR(ITEM\_PRICE, 1, INSTR(ITEM\_PRICE, \"\<\") - 1) = \"\" THEN SUBSTR(ITEM\_PRICE, INSTR(ITEM\_PRICE, \"\<\") + 1) / 2 WHEN INSTR(ITEM\_PRICE, \"\<\") \<\> 0 THEN SUBSTR(ITEM\_PRICE, 1, INSTR(ITEM\_PRICE, \"\<\") - 1) + (SUBSTR(ITEM\_PRICE, INSTR(ITEM\_PRICE, \"\<\") + 1) - SUBSTR(ITEM\_PRICE, 1, INSTR(ITEM\_PRICE, \"\<\") - 1)) / 2 WHEN INSTR(ITEM\_PRICE, \"\>\") \<\> 0 THEN SUBSTR(ITEM\_PRICE, INSTR(ITEM\_PRICE, \"\>\") + 1) / 2 ELSE 0 END) AS \"TOTAL\" FROM vendeur2 GROUP BY ITEM\_PRICE, PRODUCT\_TYPE, PRODUCT\_FAMILY
  10   Créer la table produits (à partir des tables vendeur1 & vendeur2) comportant le montant des types de produits par famille de produits : pas de doublons svp                                                                                                                                                                                                        CREATE TABLE products SELECT PRODUCT\_TYPE, PRODUCT\_FAMILY, ITEM\_PRICE, SUM(CASE WHEN INSTR(PURCHASE\_COUNT, \"\<\") \<\> 0 AND SUBSTR(PURCHASE\_COUNT, 1, INSTR(PURCHASE\_COUNT, \"\<\") - 1) = \"\" THEN SUBSTR(PURCHASE\_COUNT, INSTR(PURCHASE\_COUNT, \"\<\") + 1) / 2 WHEN INSTR(PURCHASE\_COUNT, \"\<\") \<\> 0 THEN SUBSTR(PURCHASE\_COUNT, 1, INSTR(PURCHASE\_COUNT, \"\<\") - 1) + (SUBSTR(PURCHASE\_COUNT, INSTR(PURCHASE\_COUNT, \"\<\") + 1) - SUBSTR(PURCHASE\_COUNT, 1, INSTR(PURCHASE\_COUNT, \"\<\") - 1)) / 2 WHEN INSTR(PURCHASE\_COUNT, \"\>\") \<\> 0 THEN SUBSTR(PURCHASE\_COUNT, INSTR(PURCHASE\_COUNT, \"\>\") + 1) / 2 ELSE 0 END) AS \"MOYENNE\", SUM(CASE WHEN INSTR(ITEM\_PRICE, \"\<\") \<\> 0 AND SUBSTR(ITEM\_PRICE, 1, INSTR(ITEM\_PRICE, \"\<\") - 1) = \"\" THEN SUBSTR(ITEM\_PRICE, INSTR(ITEM\_PRICE, \"\<\") + 1) / 2 WHEN INSTR(ITEM\_PRICE, \"\<\") \<\> 0 THEN SUBSTR(ITEM\_PRICE, 1, INSTR(ITEM\_PRICE, \"\<\") - 1) + (SUBSTR(ITEM\_PRICE, INSTR(ITEM\_PRICE, \"\<\") + 1) - SUBSTR(ITEM\_PRICE, 1, INSTR(ITEM\_PRICE, \"\<\") - 1)) / 2 WHEN INSTR(ITEM\_PRICE, \"\>\") \<\> 0 THEN SUBSTR(ITEM\_PRICE, INSTR(ITEM\_PRICE, \"\>\") + 1) / 2 ELSE 0 END) AS \"TOTAL\" FROM vendeur1 GROUP BY ITEM\_PRICE, PRODUCT\_TYPE, PRODUCT\_FAMILY UNION SELECT PRODUCT\_TYPE, PRODUCT\_FAMILY, ITEM\_PRICE, SUM(CASE WHEN INSTR(PURCHASE\_COUNT, \"\<\") \<\> 0 AND SUBSTR(PURCHASE\_COUNT, 1, INSTR(PURCHASE\_COUNT, \"\<\") - 1) = \"\" THEN SUBSTR(PURCHASE\_COUNT, INSTR(PURCHASE\_COUNT, \"\<\") + 1) / 2 WHEN INSTR(PURCHASE\_COUNT, \"\<\") \<\> 0 THEN SUBSTR(PURCHASE\_COUNT, 1, INSTR(PURCHASE\_COUNT, \"\<\") - 1) + (SUBSTR(PURCHASE\_COUNT, INSTR(PURCHASE\_COUNT, \"\<\") + 1) - SUBSTR(PURCHASE\_COUNT, 1, INSTR(PURCHASE\_COUNT, \"\<\") - 1)) / 2 WHEN INSTR(PURCHASE\_COUNT, \"\>\") \<\> 0 THEN SUBSTR(PURCHASE\_COUNT, INSTR(PURCHASE\_COUNT, \"\>\") + 1) / 2 ELSE 0 END) AS \"MOYENNE\", SUM(CASE WHEN INSTR(ITEM\_PRICE, \"\<\") \<\> 0 AND SUBSTR(ITEM\_PRICE, 1, INSTR(ITEM\_PRICE, \"\<\") - 1) = \"\" THEN SUBSTR(ITEM\_PRICE, INSTR(ITEM\_PRICE, \"\<\") + 1) / 2 WHEN INSTR(ITEM\_PRICE, \"\<\") \<\> 0 THEN SUBSTR(ITEM\_PRICE, 1, INSTR(ITEM\_PRICE, \"\<\") - 1) + (SUBSTR(ITEM\_PRICE, INSTR(ITEM\_PRICE, \"\<\") + 1) - SUBSTR(ITEM\_PRICE, 1, INSTR(ITEM\_PRICE, \"\<\") - 1)) / 2 WHEN INSTR(ITEM\_PRICE, \"\>\") \<\> 0 THEN SUBSTR(ITEM\_PRICE, INSTR(ITEM\_PRICE, \"\>\") + 1) / 2 ELSE 0 END) AS \"TOTAL\" FROM vendeur2 GROUP BY ITEM\_PRICE, PRODUCT\_TYPE, PRODUCT\_FAMILY
  11   En considérant que le deuxième achat effectué par un client constitue un complément d\'achat et non un doublon, l\'entreprise vous demande de créer à partir du fichier csv de départ une nouvelle table nommée vente\_finale en affichant pas les ventes complémentaires. Toutefois les montants affectés à ces ventes doivent figurer dans la nouvelles table.   
  ---- ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
